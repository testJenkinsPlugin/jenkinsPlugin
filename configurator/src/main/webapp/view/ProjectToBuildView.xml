<?xml version="1.0"?>
<j:jelly xmlns:j="jelly:core"
   xmlns:st="jelly:stapler"
   xmlns:d="jelly:define"
   xmlns:l="/lib/layout"
   xmlns:t="/lib/hudson"
   xmlns:f="/lib/form"
   xmlns:i="jelly:fmt"
   xmlns:p="/lib/hudson/project"
   >

	<div id="${divID}" name="projectToBuild" class="div-add-project-to-build-view">
		<label id="close_${divID}" onclick="closeButtonClick(this)" class="close-project-to-build">X</label>

		<div class="div-folder-chooser">
			<div class="div-file-chooser-label">
				<label>Project url:</label>
			</div>
			<div>
				<input type="text" id="project_Url_${sourceId[0]}" name="projectUrl" value="${view.getProjectUrl()}" class="textbox"/>
			</div>
		</div>

		<div class="div-url-type">
			<j:forEach items="${sourceControlTool}" var="sct" indexVar="i">
				<j:if test="${sct == view.getType()}">
					<input type="radio" name="sourceControlTool_${divID}" onclick="urlTypeChange(this)" checked="checked" value="${sct.name()}"/>${sct}
				</j:if>
				<j:if test="${sct != view.getType()}">
					<input type="radio" name="sourceControlTool_${divID}" onclick="urlTypeChange(this)"  value="${sct.name()}"/>${sct}
				</j:if>
				<br/>
			</j:forEach>
			<input type="hidden" name="type" value="${view.getType().name()}" id="sourceControlTool_${divID}"/>
		</div>

		<div class="div-folder-chooser">
			<div class="div-file-chooser-label">
				<label>Project to build:</label>
			</div>
			<div class="left">
				<input type="text" id="files_${sourceId[0]}" name="fileToBuild" value="${view.getFileToBuild()}" onchange="rootFolderChange()" class="textbox"/>
			</div>
			<div>
				<applet code="FileChooser.class" archive="FileChooser.jar" id="applet_${sourceId[0]}" codebase="../plugin/configurator/applet/" class="applet">
					<span></span>
				</applet>
			</div>
		</div>

		<div class="div-project-to-build">
			<div class="project-to-build-label">
				<label class="div-label">Path to artefacts:</label>
			</div>
			<applet code="FileChooser.class" archive="FileChooser.jar" id="applet_${sourceId[1]}" class="applet" codebase="../plugin/configurator/applet/">
				<span></span>
			</applet>

			<div class="div-legend">
				<fieldset>
					<legend>Artefacts</legend>
					<select id="files_${sourceId[1]}" name="artefacts_group" class="select" onchange="selectionBoxIndexChange(this)" size="3">
					
					<j:set var="forHidden" value=""/>
					<j:forEach items="${view.getArtefacts()}" var="art" indexVar="i">
						<option value="${art}">${art}</option>
						<j:set var="forHidden" value="${forHidden+art+';'}"/>
					</j:forEach>
					</select>
				</fieldset>

				<input type="hidden" name="artefacts" value="${forHidden}" id="files_hidden_${sourceId[1]}"/>
			</div>
		</div>

		<div class="div-project-to-build">

				<j:if test="${view.IsVersionFiles()}">
					<div class="project-to-build-label">
						<input type="checkbox" class="check-box" name="isVersionFiles" checked="checked" onclick="versionFileCheckBoxChange(this)" id="isVersionFiles_${sourceId[2]}"/>
						<label class="div-label">Version Files</label>
					</div>
					<applet code="FileChooser.class" archive="FileChooser.jar" id="applet_${sourceId[2]}" class="applet" codebase="../plugin/configurator/applet/">
						<span></span>
					</applet>
				</j:if>
				<j:if test="${!view.IsVersionFiles()}">
					<div class="project-to-build-label">
						<input type="checkbox" class="check-box" name="isVersionFiles" onclick="versionFileCheckBoxChange(this)" id="isVersionFiles_${sourceId[2]}"/>
						<label class="div-label">Version Files</label>
					</div>
					<applet code="FileChooser.class" archive="FileChooser.jar" id="applet_${sourceId[2]}" class="applet-version-file" codebase="../plugin/configurator/applet/">
						<span></span>
					</applet>
				</j:if>

			<div class="div-legend">
				<fieldset>
					<legend>Version Files</legend>
					<select id="files_${sourceId[2]}" name="vFiles_${sourceId[1]}" class="select" onchange="selectionBoxIndexChange(this)" size="3">
						<j:set var="forHidden" value=""/>
						<j:forEach items="${view.getVersionFiles()}" var="vf" indexVar="i">
							<option value="${vf}">${vf}</option>
							<j:set var="forHidden" value="${forHidden+vf+';'}"/>
						</j:forEach>
					</select>
				</fieldset>

				<input type="hidden" name="versionFiles" value="${forHidden}" id="files_hidden_${sourceId[2]}"/>
			</div>
		</div>

		<div id="builders_${divID}" class="builders">
			<j:forEach items="${view.getBuilders()}" var="build" indexVar="i">
				${generator.getBuilderView(build).getHtml()}
			</j:forEach>
			<span></span>
		</div>

		<div id="addView_${divID}" class="div-add-view">
			<input type="button" onClick="addBuilder(this)" id="addBuilders_${divID}" value="Add Builder"/>
		</div>
	</div>
	<j:forEach items="s" var="config" indexVar="i">
	</j:forEach>
</j:jelly>