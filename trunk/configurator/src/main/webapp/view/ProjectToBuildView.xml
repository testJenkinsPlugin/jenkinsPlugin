<?xml version="1.0"?>
<j:jelly xmlns:j="jelly:core"
   xmlns:st="jelly:stapler"
   xmlns:d="jelly:define"
   xmlns:l="/lib/layout"
   xmlns:t="/lib/hudson"
   xmlns:f="/lib/form"
   xmlns:i="jelly:fmt"
   xmlns:p="/lib/hudson/project"
   >
    <div id="${divID}" name="projectToBuild" class="div-add-project-to-build-view">
        <label id="close_${divID}" onclick="closeButtonClick(this)" class="close-project-to-build">X</label>
        <div class="div-folder-chooser">
            <div class="div-file-chooser-label">
                <label>Project url:</label>
            </div>
            <div>        
                <input type="text" id="project_Url_${sourceId[0]}" name="projectUrl" onblur="checkURL(id,'url')" value="${view.getProjectUrl()}" class="textbox"/>        
            </div>
            <div id="url_error_${sourceId[0]}url" class="error-none">
            <img src="../images/16x16/error.png"/>
                Not correct url
            </div>
        </div>

        <div class="div-textinput">
            <div class="div-file-chooser-label">
                <label>Project folder path:</label>
            </div>
            <div class="left">
                <input type="text" id="projectFolderPath_${sourceId[0]}" onblur="checkPath(id)" value="${view.getProjectFolderPath()}" name="projectFolderPath" class="textbox"/>
                <img id="image_${sourceId[0]}" src="/static/c2e30787/images/16x16/help.png" onClick="imageHelp(id+'path')" class="image"/>
            </div>
        </div>
        <div id="path_error_${sourceId[0]}" class="error-none">
        <img src="../images/16x16/error.png"/>
                Not correct path
        </div>
        <div id="block_help_${sourceId[0]}path" class="help-view">
            <lebel id="text_help_${sourceId[0]}path" class="helptext">
                 Base folder
            </lebel>
        </div>

        <div class="div-textinput">
            <div class="div-file-chooser-label">
                <label>Project to build:</label>
            </div>
            <div class="left">
                <input type="text" id="project_to_build_${sourceId[0]}" name="fileToBuild" onblur="checkPTB(id)" value="${view.getFileToBuild()}" class="textbox"/>
                <img id="image_${sourceId[0]}" src="/static/c2e30787/images/16x16/help.png" onClick="imageHelp(id+'build')" class="image"/>
            </div>
        </div>
        <div>
            <div id="ptb_error_${sourceId[0]}" class="error-none">
                <img src="../images/16x16/error.png"/>
                Not correct file name
            </div>

            <div id="block_help_${sourceId[0]}build" class="help-view">
                <lebel id="text_help_${sourceId[0]}build" class="helptext">
                    Project file name (with extension)
                </lebel>
            </div>
        </div>
        
        <div class="div-project-to-build">
            <div class="project-to-build-label">
                <label class="div-file-chooser-label">Path to artefacts:</label>
            </div>
            <div>
                <input type="text" id="path_input_${sourceId[1]}" name="pathToArtefacts" onblur="checkPath(id)" class="textbox"/>
                <input type="button" id="add_button_${sourceId[1]}" onclick="addPath(this)" class="div-plus-button" value="+"/>
                <img id="image_${sourceId[0]}" src="/static/c2e30787/images/16x16/help.png" onClick="imageHelp(id+'art')" class="image"/>
            </div>
            <div id="path_error_${sourceId[1]}" class="error-none">
            <img src="../images/16x16/error.png"/>
                <label id="coincide_${sourceId[1]}"> Not correct path</label>
            </div>
            <div id="block_help_${sourceId[0]}art" class="help-view">
                <lebel id="text_help_${sourceId[0]}art" class="helptext">
                 Relative path
                </lebel>
            </div>
            <div class="div-legend">
                <fieldset>
                    <legend>Artefacts</legend>
                    <select id="files_${sourceId[1]}" name="artefacts_group" class="select" onchange="selectionBoxIndexChange(this)" size="3">
                        <j:set var="forHidden" value=""/>
                        <j:forEach items="${view.getArtefacts()}" var="art" indexVar="i">
                            <option value="${art}">${art}</option>
                            <j:set var="forHidden" value="${forHidden+art+';'}"/>
                        </j:forEach>
                    </select>
                </fieldset>

                <input type="hidden" name="artefacts" value="${forHidden}" id="files_hidden_${sourceId[1]}"/>
            </div>
        </div>

        <div  class="div-project-version-file">

            <j:if test="${view.IsVersionFiles()}">
                <div class="project-to-build-label">
                    <input type="checkbox" class="check-box" name="isVersionFiles" checked="checked" onclick="versionFileCheckBoxChange(this)" id="isVersionFiles_${sourceId[2]}"/>
                    <label class="div-label">Version Files</label>
                </div>
                <input type="text" id="path_input_${sourceId[2]}" name="versionFilesPath" onblur="checkPath(id)" class="textbox"/>
                <input type="button" onclick="addPathFiles(this)" class="div-plus-button" id="add_button_${sourceId[2]}" value="+"/>
            </j:if>
            <j:if test="${!view.IsVersionFiles()}">
                <div class="project-to-build-label">
                    <input type="checkbox" class="check-box" name="isVersionFiles" onclick="versionFileCheckBoxChange(this)" id="isVersionFiles_${sourceId[2]}"/>
                    <label class="div-label">Version Files</label>
                </div>
                <input type="text" id="path_input_${sourceId[2]}" name="versionFilesPath" onblur="checkPath(id)" class="textbox-hidden"/>
                <input type="button" onclick="addPathFiles(this)" class="div-plus-button-hidden" id="add_button_${sourceId[2]}" value="+"/>
            </j:if>
            <div id="path_error_${sourceId[2]}" class="error-none">
            <img src="../images/16x16/error.png"/>
                <label id="coincide_${sourceId[2]}"> Not correct path</label>
            </div>
            
            <j:if test="${view.IsVersionFiles()}">
            <div id = "div-fieldset_${sourceId[2]}" class="div-legend">
                <fieldset>
                    <legend>Version Files</legend>
                    <select id="files_${sourceId[2]}" name="vFiles_${sourceId[1]}"  class="select" onchange="selectionBoxIndexChange(this)" size="3">
                        <j:set var="forHidden" value=""/>
                        <j:forEach items="${view.getVersionFiles()}" var="vf" indexVar="i">
                            <option value="${vf}">${vf}</option>
                            <j:set var="forHidden" value="${forHidden+vf+';'}"/>
                        </j:forEach>
                    </select>
                </fieldset>
                <input type="hidden" name="versionFiles" value="${forHidden}" id="files_hidden_${sourceId[2]}"/>
            </div>
            </j:if>
            <j:if test="${!view.IsVersionFiles()}">
            <div id = "div-fieldset_${sourceId[2]}" class="div-legend-hidden">
                <fieldset>
                    <legend>Version Files</legend>
                    <select id="files_${sourceId[2]}" name="vFiles_${sourceId[1]}"  class="select-hidden" onchange="selectionBoxIndexChange(this)" size="3">
                        <j:set var="forHidden" value=""/>
                        <j:forEach items="${view.getVersionFiles()}" var="vf" indexVar="i">
                            <option value="${vf}">${vf}</option>
                            <j:set var="forHidden" value="${forHidden+vf+';'}"/>
                        </j:forEach>
                    </select>
                </fieldset>
                <input type="hidden" name="versionFiles" value="${forHidden}" id="files_hidden_${sourceId[2]}"/>
            </div>
            </j:if>
        </div>

        <div id="builders_${divID}" class="builders">
            <j:forEach items="${view.getBuilders()}" var="build" indexVar="i">
                ${generator.getBuilderView(build).getHtml()}
            </j:forEach>
            <span></span>
        </div>

        <div id="addView_${divID}" class="div-add-view">
            <input type="button" onClick="addBuilder(this)" id="addBuilders_${divID}" value="Add Builder"/>
        </div>
    </div>
    <j:forEach items="s" var="config" indexVar="i">
    </j:forEach>
</j:jelly>